!function(){"use strict";function n(n){var t=!0;return this.checkValidity&&!this.checkValidity()&&(t=!1,n&&(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation()),$(this).find("input, select, textarea").each(function(){this.validity.valid||$(this).trigger("invalid",this.validity)})),t}function t(n,t){var e=n.find(".".concat(t,"-form-group"));e.length&&e.find(".invalid-message").css("display","block")}function e(t){t.on("submit",function(t){return n.call(this,t)})}var i={initialize:function(n){e(n),function(n){n.find("input, select, textarea").on("invalid",function(e){if(e.preventDefault(),this.setCustomValidity(""),!this.validity.valid){var i=$(this);i.addClass("invalid"),t(n,i.attr("name"))}})}(n),function(n){n.find('button[type="submit"], input[type="submit"]').on("click",function(){n.find(".form-control.invalid").removeClass("invalid"),n.find(".invalid-message").css("display","none")})}(n)},showError:t};function a(n){n&&n.length&&$("html, body").animate({scrollTop:n.offset().top-200},100)}function o(n){var t=parseInt(n.data("max-total-files"),10)||5,e=1024*(parseInt(n.data("max-files-size"),10)||5)*1024,i=n.data("uploaded-files")||[];return i.reduce(function(n,t){return n+t.size},0)>e||i.length>t?{valid:!1}:{valid:!0}}$(document).ready(function(){var n=$("form.custom-form-element");n.length&&(n.each(function(){console.log("Initializing custom form:",$(this).attr("id"))}),i.initialize(n),$('.custom-form-element input[type="file"]').on("change",function(n){var t=n.target.files,e=$(this),i=[];Array.from(t).forEach(function(n){(function(n){return new Promise(function(t,e){var i=new FileReader;i.onload=function(){return t(i.result)},i.onerror=function(){return e(i.error)},i.readAsArrayBuffer(n)})})(n).then(function(t){var a=new Uint8Array(t),o={name:n.name,type:n.type,size:n.size,data:Array.from(a)};i.push(o),e.data("uploaded-files",i)}).catch(function(n){console.error("Error reading file:",n)})})}),$("form.custom-form-element").on("submit",function(n){n.preventDefault();var t=$(this),e=t.find('button[type="submit"]').get(0),r=t.attr("action")||"",s=new FormData(t[0],e),c=t.parents(".form-wrapper");e.disabled=!0,t.find(".invalid-message").css("display","none"),c.spinner().start();for(var f=Array.from($('input[type="file"]',t)),l=0;l<f.length;l++){var d=$(f[l]);if(!o(d).valid)return d.parents(".form-group").find(".invalid-message").css("display","block"),e.disabled=!1,void c.spinner().stop()}f.forEach(function(n){var t=$(n),e=t.attr("name").replace("[]",""),i=t.data("uploaded-files")||[];i.forEach(function(n,t){s.append("".concat(e,"_name_").concat(t),n.name),s.append("".concat(e,"_type_").concat(t),n.type),s.append("".concat(e,"_data_").concat(t),n.data)}),s.append("".concat(e,"_count"),i.length)});var u=Object.fromEntries(s.entries()),p=JSON.stringify(u);console.log("Sending form data:",u),fetch(r,{method:"POST",redirect:"follow",headers:{"Content-Type":"text/plain;charset=utf-8"},body:p}).then(function(n){return n.json()}).then(function(n){console.log("Success:",n),n&&(n.success?(c.find(".form-header").css("display","none"),c.find(".form-inner").css("display","none"),c.find(".form-response-message").css("display","block"),a(c.find(".form-response-message"))):(i.showError(c,n.field),a(c.find(".".concat(n.field,"-form-group")))))}).catch(function(n){n&&(console.error("Error:",n),i.showError(t,n.field),a(t.find(".".concat(n.field,"-form-group"))))}).finally(function(){e.disabled=!1,c.spinner().stop()})}))})}();