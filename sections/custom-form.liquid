<div id="{{ section.settings.form_id }}" class="custom-form">
  {% if section.settings.form_name != blank %}
    <h2>{{ section.settings.form_name }}</h2>
  {% endif %}
  {% if section.settings.form_description != blank %}
    <p>{{ section.settings.form_description }}</p>
  {% endif %}

  <form action="{{ section.settings.form_action }}" method="{{ section.settings.form_method }}">
    {% for block in section.blocks %}
      {% case block.type %}
        {% when 'input' %}
          {% if block.settings.input_type != 'hidden' %}
            <label for="{{ block.settings.input_name }}">{{ block.settings.input_label }}</label>
          {% endif %}
          <input
            type="{{ block.settings.input_type }}"
            name="{{ block.settings.input_name }}"
            id="{{ block.settings.input_name }}"
            {% if block.settings.default_value != blank %}
              value="{{ block.settings.default_value }}"
            {% endif %}
            {% if block.settings.min_length %}
              minlength="{{ block.settings.min_length }}"
            {% endif %}
            {% if block.settings.max_length %}
              maxlength="{{ block.settings.max_length }}"
            {% endif %}
          >
        {% when 'select' %}
          <label for="{{ block.settings.select_name }}">{{ block.settings.select_name }}</label>
          <select name="{{ block.settings.select_name }}" id="{{ block.settings.select_name }}">
            {% assign options = block.settings.select_values | split: ',' %}
            {% for opt in options %}
              <option value="{{ opt | strip }}">{{ opt | strip }}</option>
            {% endfor %}
          </select>
      {% endcase %}
    {% endfor %}
    <button type="submit">{{ section.settings.button_text }}</button>
  </form>
</div>

{% schema %}
{
  "name": "Custom Form",
  "settings": [
    {
      "type": "text",
      "id": "form_id",
      "label": "Form ID",
      "default": "custom_form"
    },
    {
      "type": "text",
      "id": "form_name",
      "label": "Form name",
      "default": "Contact Us"
    },
    {
      "type": "text",
      "id": "form_description",
      "label": "Form description",
      "default": "Please fill in the form below."
    },
    {
      "type": "text",
      "id": "form_action",
      "label": "Form action URL",
      "default": "#"
    },
    {
      "type": "select",
      "id": "form_method",
      "label": "Form method",
      "default": "POST",
      "options": [
        { "value": "GET", "label": "GET" },
        { "value": "POST", "label": "POST" }
      ]
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Submit button text",
      "default": "Submit"
    }
  ],
  "blocks": [
    {
      "type": "input_block",
      "name": "Input field",
      "settings": [
        {
          "type": "select",
          "id": "input_type",
          "label": "Type",
          "default": "text",
          "options": [
            { "value": "text", "label": "Text" },
            { "value": "email", "label": "Email" },
            { "value": "hidden", "label": "Hidden" }
          ]
        },
        {
          "type": "text",
          "id": "input_name",
          "label": "Name"
        },
        {
          "type": "text",
          "id": "input_label",
          "label": "Label"
        },
        {
          "type": "number",
          "id": "min_length",
          "label": "Min length"
        },
        {
          "type": "number",
          "id": "max_length",
          "label": "Max length"
        },
        {
          "type": "text",
          "id": "default_value",
          "label": "Default value"
        }
      ]
    },
    {
      "type": "select_block",
      "name": "Select field",
      "settings": [
        {
          "type": "text",
          "id": "select_name",
          "label": "Name"
        },
        {
          "type": "textarea",
          "id": "select_values",
          "label": "Values (comma separated)",
          "default": "Option 1,Option 2,Option 3"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Form",
      "category": "8. Forms"
    }
  ]
}
{% endschema %}
